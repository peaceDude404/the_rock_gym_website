<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pending Dues</title>
    {{!--
    <link rel="preconnect" href="https://fonts.googleapis.com">
    --}}
    {{!-- <link rel="stylesheet" href="css/allmembers.css"> --}}
    
</head>

<body><script type="text/javascript" src="pending.js"></script>
    <main>
        <h1 class="title">Pending Dues</h1>
        <div class="list">
            <% 

            function checkPending12month(date){
                const today = new Date();
                var dc = today.getDate() , mc = today.getMonth() , yc = today.getFullYear();
                var day = date.getDate() , month = date.getMonth() , year = date.getFullYear();
                if(yc - year > 1){
                    return true;
                }
                else if(yc - year == 1){
                    if(mc - month > 0) return true;
                    else if(mc-month==0){
                        if(dc < day) return false;
                        else return true;
                    }
                    else{
                        return false;
                    }
                }
            }
            
            function checkPending1month(date){
                const today = new Date();
                var dc = today.getDate() , mc = today.getMonth() , yc = today.getFullYear();
                var day = date.getDate() , month = date.getMonth() , year = date.getFullYear();
                if(yc - year > 1){
                    return true;
                }
                else if(yc - year == 1){
                    if(month == 11 && mc == 0){
                        if(dc < day){
                            return false;
                        }
                        else{
                            return true;
                        }
                    }
                    else{
                        return true;
                    }
                }
                else{
                    if(mc - month > 1){
                        return true;
                    }
                    else if(mc - month == 1){
                        if(dc < day){
                            return false;
                        }
                        else{
                            return true;
                        }
                    }
                    return false;
                }
            }

            function checkPending3month(date){
                const today = new Date();
                var dc = today.getDate() , mc = today.getMonth() , yc = today.getFullYear();
                var day = date.getDate() , month = date.getMonth() , year = date.getFullYear();
                if(yc - year > 1){
                    return true;
                }
                else if(yc - year == 1){
                    if(month == 11 && mc == 2){
                        if(dc < day){
                            return false;
                        }
                        else{
                            return true;
                        }
                    }
                    else if(month == 10 && mc == 1){
                        if(dc < day){
                            return false;
                        }
                        else{
                            return true;
                        }
                    }
                    else if(month == 9 && mc == 0){
                        if(dc < day){
                            return false;
                        }
                        else{
                            return true;
                        }
                    }
                    else{
                        return true;
                    }
                }
                else{
                    if(mc - month > 3){
                        return true;
                    }
                    else if(mc - month == 3){
                        if(dc < day){
                            return false;
                        }
                        else{
                            return true;
                        }
                    }
                    return false;
                }
            }

            function checkPending6month(date){
                const today = new Date();
                var dc = today.getDate() , mc = today.getMonth() , yc = today.getFullYear();
                var day = date.getDate() , month = date.getMonth() , year = date.getFullYear();
                if(yc - year > 1){
                    return true;
                }
                else if(yc - year == 1){
                    if(month == 11 && mc == 5){
                        if(dc < day){
                            return false;
                        }
                        else{
                            return true;
                        }
                    }
                    else if(month == 10 && mc == 4){
                        if(dc < day){
                            return false;
                        }
                        else{
                            return true;
                        }
                    }
                    else if(month == 9 && mc == 3){
                        if(dc < day){
                            return false;
                        }
                        else{
                            return true;
                        }
                    }
                    else if(month == 8 && mc == 2){
                        if(dc < day){
                            return false;
                        }
                        else{
                            return true;
                        }
                    }
                    else if(month == 7 && mc == 1){
                        if(dc < day){
                            return false;
                        }
                        else{
                            return true;
                        }
                    }
                    else if(month == 6 && mc == 0){
                        if(dc < day){
                            return false;
                        }
                        else{
                            return true;
                        }
                    }
                    else{
                        return true;
                    }
                }
                else{
                    if(mc - month > 6){
                        return true;
                    }
                    else if(mc - month == 6){
                        if(dc < day){
                            return false;
                        }
                        else{
                            return true;
                        }
                    }
                    return false;
                }
            }

            

            function checkPackage(package, date){

                if(package == '1 month'){
                    return checkPending1month(date);
                }
                else if(package == '3 months'){
                    return checkPending3month(date);
                }
                else if(package == '6 months'){
                    return checkPending6month(date);
                }
                else{
                    return checkPending12month(date);
                }
            }

            %>
            <% result.forEach((item)=>{%>
            <% if(checkPackage(item.package, item.admission)){%>
            <div class="line">
                <div class="user">
                    <div class="profile">
                        <p id="year"><%=item.rollno%></p>
                    </div>
                    <div class="details">
                        <h1 class="name"><%=item.name%></h1>
                    </div>
                </div>
                <div class="date">
                    <span></span>
                    <p id="year"><%=item.admission.getDate()%>-<%=item.admission.getMonth()+1%>-<%=item.admission.getFullYear()%></p>
                    <p id="year"><%=item.mobile%></p>
                </div>
                <div class="update">
                    <a href="/updateData/<%=item._id%>" class="btn">Update</a>
                </div>
                <div class="Message">
                    <a href="/pendingMessageUser/<%=item._id%>" class="btn">Message</a>
                </div>
                <div class="Delete">
                    <a href="/deleteData/<%=item._id%>" class="btn">Delete</a>
                </div>
            </div>
            <% }%>
            <%})%>
        </div>
    </main>
    <script type="text/javascript">
    var yc = Date.now().getYear(), mc = Date.now().getMonth(), dc = Date.now().getDate();
var year = result.admission.getYear();
console.log(year);
document.getElementById("year").innerHTML = "sdfg";
    </script>
</body>

</html> 